<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="A short tale about the importance of good security practices while developing or auditing safe critical systems.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>A tale about security in web applications, or how I helped to save a bank from bankruptcy | Santos Gallegos</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#222222">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS (en)" hreflang="en" href="../../rss.xml">
<link rel="alternate" type="application/rss+xml" title="RSS (es)" hreflang="es" href="../../es/rss.xml">
<link rel="canonical" href="https://stsewd.dev/posts/a-tale-about-security-in-web-applications/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><!-- Custom css --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="../../assets/css/custom.css" type="text/css" media="all">
<!-- Cloudflare Web Analytics --><script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"token": "f0bcc690290a454ab2e555da28759807"}'></script><!-- End Cloudflare Web Analytics --><meta name="author" content="Santos Gallegos">
<link rel="prev" href="../devsucodejam-2019/" title="Devsu Code Jam 2019 - solutions and my experience" type="text/html">
<link rel="next" href="../securing-your-dev-environment/" title="Securing your development environment" type="text/html">
<meta property="og:site_name" content="Santos Gallegos">
<meta property="og:title" content="A tale about security in web applications, or how I helped to save a b">
<meta property="og:url" content="https://stsewd.dev/posts/a-tale-about-security-in-web-applications/">
<meta property="og:description" content="A short tale about the importance of good security practices while developing or auditing safe critical systems.">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2021-06-18T00:00:00-05:00">
<meta property="article:tag" content="experience">
<meta property="article:tag" content="security">
<link rel="alternate" hreflang="es" href="../../es/posts/a-tale-about-security-in-web-applications/">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-expand-md static-top mb-4
navbar-dark
bg-dark
"><div class="container">
<!-- This keeps the margins nice -->
        <a class="navbar-brand" href="../../">

            <span id="blog-title">Santos Gallegos</span>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bs-navbar">
            <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="../../archive.html" class="nav-link">Posts</a>
                </li>
<li class="nav-item">
<a href="../../projects/" class="nav-link">Projects</a>
                </li>
<li class="nav-item">
<a href="../../disclosed-vulnerabilities/" class="nav-link">Disclosed vulnerabilities</a>
                </li>
<li class="nav-item">
<a href="../../about/" class="nav-link">About</a>

                
            </li>
</ul>
<ul class="navbar-nav navbar-right">
<li>
            </li>
<li class="nav-item"><a href="../../es/" rel="alternate" hreflang="es" class="nav-link">Espa√±ol</a></li>

                
                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        
  

<div class="container mb-3">
  <div class="row justify-content-sm-center">
    <div class="col col-sm-8">
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">A tale about security in web applications, or how I helped to save a bank from bankruptcy</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    Santos Gallegos
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2021-06-18T00:00:00-05:00" itemprop="datePublished" title="2021-06-18">2021-06-18</time></a>
            </p>
                <p class="commentline">
    
    <a href="#disqus_thread" data-disqus-identifier="cache/posts/a-tale-about-security-in-web-applications.html">Comments</a>


            

        </p>
</div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>Hi friend, today I'm going to tell you a little story.
Some things may look familiar, or even you could feel related to some situations.
I assure you, <strong>it's mere coincidence</strong>.</p>
<section id="a-new-experience"><h2>A new experience</h2>
<p>This tale takes place in Ecuador.
It was during the lockdown that some friends contacted me to help them with a security audit.
They were forming a team (with special abilities?),
and there was missing someone with programming/web skills.</p>
<p>I was a little nervous to say yes,
since I haven't had much experience with security in the field.
But it was comforting to know that my teammates had vast experience in it.
I was excited to learn new things from them, and how the world of security, auditing, and banking works.
Oh, and I would get one of those fancy permits (salvoconducto) to go outside during lockdown.</p>
<ul class="simple">
<li><p>Wait, "banking"?</p></li>
<li><p>Oh, sorry I didn't tell you, the security audit was for a small bank.</p></li>
</ul></section><section id="first-flight"><h2>First flight</h2>
<p>And <em>the day</em> arrived.
We started with their homepage, and some small web applications.
It didn't take me much time to start finding small security bugs.
And then not so small, but not <em>that</em> critical either,
mostly things returning too much data or returning data when they shouldn't.
And it was from some old applications, so there wasn't much surprise in there,
and the data exposed wasn't from all their clients.</p>
<p>After reporting some of those bugs that seemed important to get fixed soon
we moved on to our next target: <strong>the online banking application</strong>.</p>
<p>We started with a black box test (no user).
It wasn't long since we started to find minor security bugs.
And we found some indications that the API may not be doing an appropriate check for authorization,
but without a user, it wasn't easy to guess (yet!).</p>
<ul class="simple">
<li><p>What indications?</p></li>
<li><p>Well, most of their APIs required a user ID to be present in the request.
So, instead of relying on some session cookie or authorization token previously validated by the server,
<strong>they were asking the client to explicitly pass the user's ID</strong>.</p></li>
<li><p>Oh, I see, that smells bad.</p></li>
</ul></section><section id="access-granted"><h2>Access granted</h2>
<p>After we got tired of guessing what some APIs would do and their parameters,
we created a new user and started our gray box testing.
The first thing we did was to check those precious API requests,
the parameters being sent, cookies, etc.
And then, the test we all were waiting for.
Changing the user from the request to another one...
Bingo! We got access. I mean, <strong>damn, we got access???</strong></p>
<p>After that shocking reveal, we kept digging for more endpoints to test.
The obvious one was to try to transfer money from/to other accounts, but there was a little problem.
An <a class="reference external" href="https://en.wikipedia.org/wiki/One-time_password">OTP</a> was required for each transaction.
So we first made a real transaction to check how the API works...
We realized that the OTP wasn't needed at all! <strong>It was being validated from the client side!</strong>
So, yes, we were able to transfer money to any account <strong>and</strong> from any account.
The user IDs were all incremental,
which means that you could easily steal money from everyone in the bank.</p>
<ul class="simple">
<li><p>Damn! THAT IS SHOCKING! Someone could have easily emptied the accounts of everyone!
But it would have been very obvious if it has happened.</p></li>
<li><p>Or just steal 50 cents from everyone in the bank each month.
Do you really know exactly how much money do you have in your bank account?
Would you even care if only 50 cents were missing?</p></li>
<li><p>That's a low and long game to play, but still easy to track.</p></li>
<li><p>Or you could just buy things, and pay with a wire transfer.
That way the money goes to several people instead of just one.
There are more ways you could exploit this without anyone noticing it, for sure.</p></li>
</ul></section><section id="interlude-about-boxes"><h2>Interlude - about boxes</h2>
<ul class="simple">
<li><p>So, you did a black and gray box tests, is there a white one? and what those colors mean?</p></li>
<li><p>The color thing is about how much information and access you have to the application.
In a black box test, you don't know anything about the system internals.
In a gray box test, you have some knowledge of the application, like the architecture,
technologies being used and intern access to the application (like a user!).
And finally the white one, you have access to the source code.
But we didn't do that one.</p></li>
</ul></section><section id="consequences"><h2>Consequences</h2>
<p>At this point more than shocked, <strong>I was scare and disappointed</strong>.
Scare of knowing this vulnerability existed and was <strong>easy to exploit</strong>.
The money from all the people was in danger, maybe even their lives!
And disappointed to know that this application has been sold to this bank (and others!) for a lot of money,
and the company behind it has been doing so for more than 15 years.
And also, that all these banks have been for many security audits,
and <strong>NO ONE</strong> found any of the things we reported.</p>
<ul class="simple">
<li><p>What do you mean with their lives were in danger?</p></li>
<li><p>You could disagree with me on this one,
personally I think that a bank is a <a class="reference external" href="https://en.wikipedia.org/wiki/Safety-critical_system">SCS</a>,
Nothing good can happen
if something goes wrong with people's money,
or all their savings.</p></li>
<li><p>No one found that after several audits? WOW! Why do you think they missed them?
And how the developers missed that!?</p></li>
<li><p>Sadly. Laziness, inexperience and negligence.
Here people don't like to go very <em>technical</em>,
but instead go with degrees and certifications ($$$).
And when doing the audit, they only run automated tools
without doing any manual checking, or trust that the apps are secure,
or everyone in the team knows only about networking.
And from the developers side, what can I say?
Most developers here don't know what a unit test is,
or are afraid to say "I'm not qualified to build this, we need someone else".</p></li>
</ul></section><section id="not-surprised"><h2>Not surprised</h2>
<p>I can't say this was <em>that</em> shocking,
I mean, I have seen things like this on several apps in my country before,
but seeing this happening in a bank... that's another thing.</p>
<ul class="simple">
<li><p>So, what happened after you reported this?</p></li>
<li><p>Well, the company behind the application negated that the bug existed,
but we provided enough proofs in our report that invalidated all those claims.
And they even charged the bank for fixing those vulnerabilities.</p></li>
<li><p>WTF? That's unethical.</p></li>
<li><p>Yeah, but sadly I learned that's how the banking/enterprise world works.</p></li>
</ul>
<p><strong>We found more shocking things</strong>, but I may tell you that in another occasion.</p>
</section><section id="the-end"><h2>The end</h2>
<p><strong>If you are a developer</strong>, please always make sure to write tests for you code,
especially if you are dealing with sensitive data.
If you feel you may not have enough experience to work on something,
don't be afraid to say so, and ask for help.</p>
<p><strong>If you are doing a security audit</strong>,
please bring a diverse team,
or be clear with the client about what things you may not be dealing with.</p>
<p><strong>If you are looking to do a security audit at your company</strong>,
I may know a great team with experts in different areas that <a class="reference external" href="../../about">you could hire</a>.</p>
<aside class="admonition note"><p class="admonition-title">Note</p>
<p>This tale may have been inspired by a real situation,
and some things may have been exaggerated (or maybe not?).</p>
</aside></section>
</div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/experience/" rel="tag">experience</a></li>
            <li><a class="tag p-category" href="../../categories/security/" rel="tag">security</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../devsucodejam-2019/" rel="prev" title="Devsu Code Jam 2019 - solutions and my experience">Previous post</a>
            </li>
            <li class="next">
                <a href="../securing-your-dev-environment/" rel="next" title="Securing your development environment">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
        
    
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="stsewd",
            disqus_url="https://stsewd.dev/posts/a-tale-about-security-in-web-applications/",
        disqus_title="A tale about security in web applications, or how I helped to save a bank from bankruptcy",
        disqus_identifier="cache/posts/a-tale-about-security-in-web-applications.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section></article><script>var disqus_shortname="stsewd";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div>
  </div>
</div>

  <script src="https://craig.global.ssl.fastly.net/js/mousetrap/mousetrap.min.js"></script><script src="../../assets/js/keybindings.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js"></script><script>
  anchors.add();
</script><!--End of body content--><footer id="footer"><div class="container">
    <div class="row text-center">
        <div class="col">
            <small>
                Contents ¬© 2023 <a href="mailto:stsewd@proton.me">Santos Gallegos</a> -
                Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a> -
                Hosted on <a href="https://pages.github.com/" rel="nofollow">GitHub Pages</a>
                
            </small>
        </div>
    </div>
    <div class="row text-center">
        <div class="col">
            <small>
                <a href="http://github.com/stsewd">
                <i class="fa fa-github fa-2x"></i>
                </a>
                <a href="http://twitter.com/stsewd">
                <i class="fa fa-twitter fa-2x"></i>
                </a>
            </small>
        </div>
    </div>
</div>

            
            
        </footer>
</div>
</div>


        <script src="../../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
